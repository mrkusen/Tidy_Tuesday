panel.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = NA),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
vjust = 0.1,
size = 10),
plot.caption = element_text(size = 7,
hjust = 1))+
labs(fill="Freedom \n Rating",
title = "World Freedom Index: 2020 Ratings",
caption = "Created by Matthew Kusen - @mkusen \n
data source: Freedom House, United Nations \n #TidyTuesday")+
scale_fill_discrete(na.value="grey",
type = c("#4daf4a",'#e41a1c','#377eb8'),
labels=c("Free","Not Free","Partially Free","NA"))
map_2020
citation("tidytuesdayR")
#Mapping
map_world_changed <- left_join(map_world,freedom_00_20,by = "country")
map_00_20_agg <- ggplot() +
geom_polygon(data = map_world_changed,
aes(x = long, y = lat,group = group,
fill = change_00_20),color="black") +
theme(axis.ticks = element_blank(),axis.text = element_blank(),
axis.title = element_blank(),panel.grid = element_blank(),
legend.position = c(.15,.3),
text = element_text(color = "#22211d"),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
panel.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = NA),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
vjust = 0.1,
size = 10),
plot.caption = element_text(size = 7,
hjust = 1))+
labs(fill="Freedom \n Rating",
title = "World Freedom Index: Changes in Aggregate Score (2000 - 2020)",
caption = "Created by Matthew Kusen - @mkusen \n
data source: Freedom House, United Nations \n #TidyTuesday")+
scale_fill_distiller(palette = "RdBu",
direction=1,
breaks = c(-2.5,-1.5,0,1.5,2.5),
labels = c("-2.5","-1.5", "0","+1.5", "+2.5"),
limits = c(min(-2.5), max(2.5)))
map_00_20_agg
### Geo Plot 2: World Freedom Index Changes in Aggregate Score (2000 to 2020)
#should filter for 2020 data first
freedom_2020 = freedom %>% filter(year == "2020")
map_world_joined_2021 <- left_join(map_world,freedom_2020, by = "country")
map_2020 <- ggplot() +
geom_polygon(data = map_world_joined_2021,
aes(x = long, y = lat, group = group,
fill = status)) +
theme(axis.ticks = element_blank(),axis.text = element_blank(),
axis.title = element_blank(),panel.grid = element_blank(),
legend.position = c(.15,.3),
text = element_text(color = "#22211d"),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
panel.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = NA),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
vjust = 0.1,
size = 10),
plot.caption = element_text(size = 7,
hjust = 1))+
labs(fill="Freedom \n Rating",
title = "World Freedom Index: 2020 Ratings",
caption = "Created by Matthew Kusen - @mkusen \n
data source: Freedom House, United Nations \n #TidyTuesday")+
scale_fill_discrete(na.value="grey",
type = c("#4daf4a",'#e41a1c','#377eb8'),
labels=c("Free","Not Free","Partially Free","NA"))
map_2020
citation("tidytuesdayR")
### Geo Plot 2: World Freedom Index 2020 Rating by Country
```{r geo viz 2, echo=FALSE}
#should filter for 2020 data first
freedom_2020 = freedom %>% filter(year == "2020")
map_world_joined_2021 <- left_join(map_world,freedom_2020, by = "country")
map_2020 <- ggplot() +
geom_polygon(data = map_world_joined_2021,
aes(x = long, y = lat, group = group,
fill = status)) +
theme(axis.ticks = element_blank(),axis.text = element_blank(),
axis.title = element_blank(),panel.grid = element_blank(),
legend.position = c(.15,.3),
text = element_text(color = "#22211d"),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
panel.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = NA),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
vjust = 0.1,
size = 10),
plot.caption = element_text(size = 7,
hjust = 1))+
labs(fill="Freedom \n Rating",
title = "World Freedom Index: 2020 Ratings",
caption = "Created by Matthew Kusen - @mkusen \n
data source: Freedom House, United Nations \n #TidyTuesday")+
scale_fill_discrete(na.value="grey",
type = c("#4daf4a",'#e41a1c','#377eb8'),
labels=c("Free","Not Free","Partially Free","NA"))
map_2020
citation("tidytuesdayR")
ggsave(map_2020,"freedom_index_2020.jpg")
ggsave(map_2020,file="freedom_index_2020.jpg")
map_00_20_agg
ggsave(map_00_20_agg,"22_feb_22_graphs/WFI_changes_00_20.jpg")
ggsave(map_00_20_agg,file="22_feb_22_graphs/WFI_changes_00_20.jpg")
#by percent
by_region_perc = freedom %>%
group_by(region_name,year) %>%
summarize(free = sum(status == "F"),
not_free = sum(status == "NF"),
part_free = sum(status == "PF"),
total = n(),
perc_free = free / total,
perc_not_free = not_free / total,
perc_part_free = part_free / total) %>% pivot_longer(perc_free:perc_part_free,
values_to = "perc_freedom_rating",
names_to = "type_perc")
#relevel
by_region_perc$type_perc = as_factor(by_region_perc$type_perc)
levels(by_region_perc$type_perc)
by_region_perc$type_perc = fct_relevel(by_region_perc$type_perc,"perc_not_free",after=Inf)
graph_region_perc = ggplot(by_region_perc) +
aes(x = year, y = perc_freedom_rating, fill = type_perc) +
geom_area(alpha=0.6,colour="black")+
theme_ipsum()+
facet_wrap(vars(region_name),scales = "free_x")+
scale_fill_discrete(type = c("#4daf4a",'#377eb8','#e41a1c'),
labels=c("Free","Partially Free","Not Free"))+
labs(fill="Freedom \n Ranking",
title = "World Freedom Index: Freedom Rankings",
subtitle = "    By Year and Region ",
caption = "Created by Matthew Kusen - @mkusen \n
data source: Freedom House, United Nations \n #TidyTuesday")+
xlab("Year")+
ylab("Percentage of Countries by Freedom Score")+
theme(
legend.position = c(.85,.25),
text = element_text(color = "#22211d"),
axis.title.x = element_text(hjust = .5,
size=10,vjust = .5, face="bold"),
axis.title.y = element_text(hjust = .5,
size=10,vjust = .5, face="bold"),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = 'black',
size = .2),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
size = 11),
plot.caption = element_text(size = 11,
hjust = 1)
)
graph_region_perc
ggsave(graph_region_perc,file="22_feb_22_graphs/WFI_region_year_perc.jpg")
#by percent
by_region_perc = freedom %>%
group_by(region_name,year) %>%
summarize(free = sum(status == "F"),
not_free = sum(status == "NF"),
part_free = sum(status == "PF"),
total = n(),
perc_free = free / total,
perc_not_free = not_free / total,
perc_part_free = part_free / total) %>% pivot_longer(perc_free:perc_part_free,
values_to = "perc_freedom_rating",
names_to = "type_perc")
#relevel
by_region_perc$type_perc = as_factor(by_region_perc$type_perc)
levels(by_region_perc$type_perc)
by_region_perc$type_perc = fct_relevel(by_region_perc$type_perc,"perc_not_free",after=Inf)
graph_region_perc = ggplot(by_region_perc) +
aes(x = year, y = perc_freedom_rating, fill = type_perc) +
geom_area(alpha=0.6,colour="black")+
theme_ipsum()+
facet_wrap(vars(region_name),scales = "free_x")+
scale_fill_discrete(type = c("#4daf4a",'#377eb8','#e41a1c'),
labels=c("Free","Partially Free","Not Free"))+
labs(fill="Freedom \n Ranking",
title = "World Freedom Index: Freedom Rankings",
subtitle = "    By Year and Region ",
caption = "Created by Matthew Kusen - @mkusen \n
data source: Freedom House, United Nations \n #TidyTuesday")+
xlab("Year")+
ylab("Percentage of Countries by Freedom Score")+
theme(
legend.position = c(.85,.25),
text = element_text(color = "#22211d"),
axis.title.x = element_text(hjust = .5,
size=10,vjust = .5, face="bold"),
axis.title.y = element_text(hjust = .5,
size=10,vjust = .5, face="bold"),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = 'black',
size = .2),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
size = 11),
plot.caption = element_text(size = 11,
hjust = 1)
)
graph_region_perc
ggsave(graph_region_perc,file="22_feb_22_graphs/WFI_region_year_perc.jpg")
graph_region_perc = ggplot(by_region_perc) +
aes(x = year, y = perc_freedom_rating, fill = type_perc) +
geom_area(alpha=0.6,colour="black")+
theme_ipsum()+
facet_wrap(vars(region_name),scales = "free_x")+
scale_fill_discrete(type = c("#4daf4a",'#377eb8','#e41a1c'),
labels=c("Free","Partially Free","Not Free"))+
labs(fill="Freedom \n Ranking",
title = "World Freedom Index: Freedom Rankings",
subtitle = "    By Year and Region ",
caption = "Created by Matthew Kusen - @mkusen \n
data source: Freedom House, United Nations \n #TidyTuesday")+
xlab("Year")+
ylab("Percentage of Countries by Freedom Score")+
theme(
legend.position = c(.85,.25),
text = element_text(color = "#22211d"),
axis.title.x = element_text(hjust = .5,
size=10,vjust = .5, face="bold"),
axis.title.y = element_text(hjust = .5,
size=10,vjust = .5, face="bold"),
axis.text.x = element_text(size=8),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = 'black',
size = .2),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
size = 11),
plot.caption = element_text(size = 11,
hjust = 1)
)
graph_region_perc
graph_region_perc = ggplot(by_region_perc) +
aes(x = year, y = perc_freedom_rating, fill = type_perc) +
geom_area(alpha=0.6,colour="black")+
theme_ipsum()+
facet_wrap(vars(region_name),scales = "free_x")+
scale_fill_discrete(type = c("#4daf4a",'#377eb8','#e41a1c'),
labels=c("Free","Partially Free","Not Free"))+
labs(fill="Freedom \n Ranking",
title = "World Freedom Index: Freedom Rankings",
subtitle = "    By Year and Region ",
caption = "Created by Matthew Kusen - @mkusen \n
data source: Freedom House, United Nations \n #TidyTuesday")+
xlab("Year")+
ylab("Percentage of Countries by Freedom Score")+
theme(
legend.position = c(.85,.25),
text = element_text(color = "#22211d"),
axis.title.x = element_text(hjust = .5,
size=10,vjust = .5, face="bold"),
axis.title.y = element_text(hjust = .5,
size=10,vjust = .5, face="bold"),
axis.text.x = element_text(size=8)
axis.text.y = element_text(size=9),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = 'black',
size = .2),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
size = 11),
plot.caption = element_text(size = 11,
hjust = 1)
)
graph_region_perc = ggplot(by_region_perc) +
aes(x = year, y = perc_freedom_rating, fill = type_perc) +
geom_area(alpha=0.6,colour="black")+
theme_ipsum()+
facet_wrap(vars(region_name),scales = "free_x")+
scale_fill_discrete(type = c("#4daf4a",'#377eb8','#e41a1c'),
labels=c("Free","Partially Free","Not Free"))+
labs(fill="Freedom \n Ranking",
title = "World Freedom Index: Freedom Rankings",
subtitle = "    By Year and Region ",
caption = "Created by Matthew Kusen - @mkusen \n
data source: Freedom House, United Nations \n #TidyTuesday")+
xlab("Year")+
ylab("Percentage of Countries by Freedom Score")+
theme(
legend.position = c(.85,.25),
text = element_text(color = "#22211d"),
axis.title.x = element_text(hjust = .5,
size=10,vjust = .5, face="bold"),
axis.title.y = element_text(hjust = .5,
size=10,vjust = .5, face="bold"),
axis.text.x = element_text(size=8),
axis.text.y = element_text(size=9),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = 'black',
size = .2),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
size = 11),
plot.caption = element_text(size = 11,
hjust = 1)
)
graph_region_perc
ggsave(graph_region_perc,file="22_feb_22_graphs/WFI_region_year_perc.jpg")
#Mapping
map_world_changed <- left_join(map_world,freedom_00_20,by = "country")
map_00_20_agg <- ggplot() +
geom_polygon(data = map_world_changed,
aes(x = long, y = lat,group = group,
fill = change_00_20),color="black") +
theme(axis.ticks = element_blank(),axis.text = element_blank(),
axis.title = element_blank(),panel.grid = element_blank(),
legend.position = c(.15,.3),
text = element_text(color = "#22211d"),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
panel.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = NA),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
vjust = 0.1,
size = 10),
plot.caption = element_text(size = 7,
hjust = 1))+
labs(fill="Freedom \n Rating",
title = "World Freedom Index: Changes in Aggregate Score (2000 - 2020)",
caption = "Created by Matthew Kusen - @mkusen \n
data source: Freedom House, United Nations \n #TidyTuesday")+
scale_fill_distiller(palette = "RdBu",
direction=1,
breaks = c(-2.5,-1.5,0,1.5,2.5),
labels = c("-2.5","-1.5", "0","+1.5", "+2.5"),
limits = c(min(-2.5), max(2.5)))
map_00_20_agg
ggsave(map_00_20_agg,file="22_feb_22_graphs/WFI_changes_00_20.jpg")
graph_region_perc = ggplot(by_region_perc) +
aes(x = year, y = perc_freedom_rating, fill = type_perc) +
geom_area(alpha=0.6,colour="black")+
theme_ipsum()+
facet_wrap(vars(region_name),scales = "free_x",scales="free_y")+
scale_fill_discrete(type = c("#4daf4a",'#377eb8','#e41a1c'),
labels=c("Free","Partially Free","Not Free"))+
labs(fill="Freedom \n Ranking",
title = "World Freedom Index: Freedom Rankings",
subtitle = "    By Year and Region ",
caption = "Created by Matthew Kusen - @mkusen \n
data source: Freedom House, United Nations \n #TidyTuesday")+
xlab("Year")+
ylab("Percentage of Countries by Freedom Score")+
theme(
legend.position = c(.85,.25),
text = element_text(color = "#22211d"),
axis.title.x = element_text(hjust = .5,
size=10,vjust = .5, face="bold"),
axis.title.y = element_text(hjust = .5,
size=10,vjust = .5, face="bold"),
axis.text.x = element_text(size=8),
axis.text.y = element_text(size=9),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = 'black',
size = .2),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
size = 11),
plot.caption = element_text(size = 11,
hjust = 1)
)
graph_region_perc
graph_region_perc = ggplot(by_region_perc) +
aes(x = year, y = perc_freedom_rating, fill = type_perc) +
geom_area(alpha=0.6,colour="black")+
theme_ipsum()+
facet_wrap(vars(region_name),scales = free)+
scale_fill_discrete(type = c("#4daf4a",'#377eb8','#e41a1c'),
labels=c("Free","Partially Free","Not Free"))+
labs(fill="Freedom \n Ranking",
title = "World Freedom Index: Freedom Rankings",
subtitle = "    By Year and Region ",
caption = "Created by Matthew Kusen - @mkusen \n
data source: Freedom House, United Nations \n #TidyTuesday")+
xlab("Year")+
ylab("Percentage of Countries by Freedom Score")+
theme(
legend.position = c(.85,.25),
text = element_text(color = "#22211d"),
axis.title.x = element_text(hjust = .5,
size=10,vjust = .5, face="bold"),
axis.title.y = element_text(hjust = .5,
size=10,vjust = .5, face="bold"),
axis.text.x = element_text(size=8),
axis.text.y = element_text(size=9),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = 'black',
size = .2),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
size = 11),
plot.caption = element_text(size = 11,
hjust = 1)
)
graph_region_perc = ggplot(by_region_perc) +
aes(x = year, y = perc_freedom_rating, fill = type_perc) +
geom_area(alpha=0.6,colour="black")+
theme_ipsum()+
facet_wrap(vars(region_name),scales = "free")+
scale_fill_discrete(type = c("#4daf4a",'#377eb8','#e41a1c'),
labels=c("Free","Partially Free","Not Free"))+
labs(fill="Freedom \n Ranking",
title = "World Freedom Index: Freedom Rankings",
subtitle = "    By Year and Region ",
caption = "Created by Matthew Kusen - @mkusen \n
data source: Freedom House, United Nations \n #TidyTuesday")+
xlab("Year")+
ylab("Percentage of Countries by Freedom Score")+
theme(
legend.position = c(.85,.25),
text = element_text(color = "#22211d"),
axis.title.x = element_text(hjust = .5,
size=8,vjust = .5, face="bold"),
axis.title.y = element_text(hjust = .5,
size=10,vjust = .5, face="bold"),
axis.text.x = element_text(size=8),
axis.text.y = element_text(size=9),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = 'black',
size = .2),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
size = 11),
plot.caption = element_text(size = 11,
hjust = 1)
)
#r4ds #tidyverse #rstats #datavizgraph_region_perc
ggsave(graph_region_perc,file="22_feb_22_graphs/WFI_region_year_perc.jpg")
graph_region_perc = ggplot(by_region_perc) +
aes(x = year, y = perc_freedom_rating, fill = type_perc) +
geom_area(alpha=0.6,colour="black")+
theme_ipsum()+
facet_wrap(vars(region_name),scales = "free")+
scale_fill_discrete(type = c("#4daf4a",'#377eb8','#e41a1c'),
labels=c("Free","Partially Free","Not Free"))+
labs(fill="Freedom \n Ranking",
title = "World Freedom Index: Freedom Rankings",
subtitle = "    By Year and Region ",
caption = "Created by Matthew Kusen - @mkusen \n
data source: Freedom House, United Nations \n #TidyTuesday")+
xlab("Year")+
ylab("Percentage of Countries by Freedom Score")+
theme(
legend.position = c(.85,.25),
text = element_text(color = "#22211d"),
axis.title.x = element_text(hjust = .5,
size=8,vjust = .5, face="bold"),
axis.title.y = element_text(hjust = .5,
size=10,vjust = .5, face="bold"),
axis.text.x = element_text(size=8),
axis.text.y = element_text(size=9),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = 'black',
size = .2),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
size = 11),
plot.caption = element_text(size = 11,
hjust = 1)
)
graph_region_perc
#r4ds #tidyverse #rstats #datavizgraph_region_perc
ggsave(graph_region_perc,file="22_feb_22_graphs/WFI_region_year_perc.jpg")
