assign(output_name, g)
}
plots <- lapply(unique(freedom$Region_Name),
get_plot)
plots
View(plots)
plots[[4]]
plots[[3]]
p1 <- plots[[3]] + plots[[1]] + plots[[2]] + plots[[4]] + plots[[5]] +
guide_area() +
annotate("text", x = 0.5, y = 0.1, label = "Title") +
plot_layout(design = layout, guides = "collect") &
theme(legend.position = "bottom",
text = element_text(size = 13, family = "Abel"))
p1
View(p1)
p1 / selected_countries +
plot_annotation(title = "Freedom in the World - Political rights",
caption = "Data: Freedom House, United Nations"))
p1 / selected_countries +
plot_annotation(title = "Freedom in the World - Political rights",
caption = "Data: Freedom House, United Nations")
p1 <- plots[[3]] + plots[[1]] + plots[[2]] + plots[[4]] + plots[[5]] +
guide_area() +
annotate("text", x = 0.5, y = 0.1, label = "Title") +
plot_layout(design = layout, guides = "collect") &
theme(legend.position = "bottom")
p1
p1 / selected_countries +
plot_annotation(title = "Freedom in the World - Political rights",
caption = "Data: Freedom House, United Nations")
p1 / selected_countries
p1 / selected_countries +
plot_annotation(title = "Freedom in the World - Political rights",
caption = "Data: Freedom House, United Nations")
p1 <- plots[[3]] + plots[[1]] + plots[[2]] + plots[[4]] + plots[[5]] +
guide_area() +
annotate("text", x = 0.5, y = 0.1, label = "Title") +
plot_layout(design = layout, guides = "collect") &
theme(legend.position = "bottom")
p1
map_disability_send + map_disability_receive
map_disability_receive <- ggplot() +
geom_polygon(data = map_europe_disability,
aes(x = long, y = lat, group = group,
fill = perc_receive)) +
theme(axis.ticks = element_blank(),axis.text = element_blank(),
axis.title = element_blank(),panel.grid = element_blank(),
legend.position = "bottom",
text = element_text(color = "#22211d"),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
panel.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = NA),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
vjust = 0.1,
size = 10),
plot.caption = element_text(size = 7,
hjust = 1))+
labs(fill="Percentage with a \n Disability Received",
title = "Percentage of Erasmus students \n received with a Disability (2014-2020)",
caption = "Created by Matthew Kusen - @mkusen \n
data source: Erasmus Student Mobility - https://data.europa.eu \n #TidyTuesday")+
scale_fill_gradientn(colors = met.brewer("Hokusai2",type="continuous"),
labels= c("0", "2%", "4%", "6%"))
map_disability_receive
map_disability_send <- ggplot() +
geom_polygon(data = map_europe_disability,
aes(x = long, y = lat, group = group,
fill = perc_send)) +
theme(axis.ticks = element_blank(),axis.text = element_blank(),
axis.title = element_blank(),panel.grid = element_blank(),
legend.position = "bottom",
text = element_text(color = "#22211d"),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
panel.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = NA),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
vjust = 0.1,
size = 10),
plot.caption = element_text(size = 7,
hjust = 1))+
labs(fill="Percentage with a \n Disability Sent",
title = "Percentage of Erasmus students \n sent with a Disability (2014-2020)")+
scale_fill_gradientn(colors = met.brewer("VanGogh3",type="continuous"),
labels= c("0", "2%", "4%", "6%"))
map_disability_send
map_disability_send <- ggplot() +
geom_polygon(data = map_europe_disability,
aes(x = long, y = lat, group = group,
fill = perc_send)) +
theme(axis.ticks = element_blank(),axis.text = element_blank(),
axis.title = element_blank(),panel.grid = element_blank(),
legend.position = "bottom",
text = element_text(color = "#22211d"),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
panel.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = NA),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
vjust = 0.1,
size = 10),
plot.caption = element_text(size = 7,
hjust = 1))+
labs(fill="Percentage with a \n Disability Sent",
title = "Percentage of Erasmus students \n sent with a Disability (2014-2020)")+
scale_fill_gradientn(colors = met.brewer("VanGogh3",type="continuous"),
labels= c("0", "2%", "4%", "6%"))
map_disability_send
map_disability_send <- ggplot() +
geom_polygon(data = map_europe_disability,
aes(x = long, y = lat, group = group,
fill = perc_send)) +
theme(axis.ticks = element_blank(),axis.text = element_blank(),
axis.title = element_blank(),panel.grid = element_blank(),
legend.position = "bottom",
text = element_text(color = "#22211d"),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
panel.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = NA),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
vjust = 0.1,
size = 10),
plot.caption = element_text(size = 7,
hjust = 1))+
labs(fill="Percentage with a \n Disability Sent",
title = "Percentage of Erasmus students \n sent with a Disability (2014-2020)")+
scale_fill_gradientn(colors = met.brewer("VanGogh3",type="continuous"),
labels=c("0", "2%", "4%", "6%"))
map_disability_send
map_disability_send <- ggplot() +
geom_polygon(data = map_europe_disability,
aes(x = long, y = lat, group = group,
fill = perc_send)) +
theme(axis.ticks = element_blank(),axis.text = element_blank(),
axis.title = element_blank(),panel.grid = element_blank(),
legend.position = "bottom",
text = element_text(color = "#22211d"),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
panel.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = NA),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
vjust = 0.1,
size = 10),
plot.caption = element_text(size = 7,
hjust = 1))+
labs(fill="Percentage with a \n Disability Sent",
title = "Percentage of Erasmus students \n sent with a Disability (2014-2020)")+
scale_fill_gradientn(colors = met.brewer("VanGogh3",type="continuous"),
labels= c("0", "2%", "4%", "6%"))
map_disability_send
map_disability_send <- ggplot() +
geom_polygon(data = map_europe_disability,
aes(x = long, y = lat, group = group,
fill = perc_send)) +
theme(axis.ticks = element_blank(),axis.text = element_blank(),
axis.title = element_blank(),panel.grid = element_blank(),
legend.position = "bottom",
text = element_text(color = "#22211d"),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
panel.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = NA),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
vjust = 0.1,
size = 10),
plot.caption = element_text(size = 7,
hjust = 1))+
labs(fill="Percentage with a \n Disability Sent",
title = "Percentage of Erasmus students \n sent with a Disability (2014-2020)")+
scale_fill_gradientn(colors = met.brewer("VanGogh3",type="continuous"))
map_disability_send
map_disability_receive <- ggplot() +
geom_polygon(data = map_europe_disability,
aes(x = long, y = lat, group = group,
fill = perc_receive)) +
theme(axis.ticks = element_blank(),axis.text = element_blank(),
axis.title = element_blank(),panel.grid = element_blank(),
legend.position = "bottom",
text = element_text(color = "#22211d"),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
panel.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = NA),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
vjust = 0.1,
size = 10),
plot.caption = element_text(size = 7,
hjust = 1))+
labs(fill="Percentage with a \n Disability Received",
title = "Percentage of Erasmus students \n received with a Disability (2014-2020)",
caption = "Created by Matthew Kusen - @mkusen \n
data source: Erasmus Student Mobility - https://data.europa.eu \n #TidyTuesday")+
scale_fill_gradientn(colors = met.brewer("Hokusai2",type="continuous"),
labels= c("0", "2%", "4%", "6%"))
map_disability_receive
map_disability_send <- ggplot() +
geom_polygon(data = map_europe_disability,
aes(x = long, y = lat, group = group,
fill = perc_send)) +
theme(axis.ticks = element_blank(),axis.text = element_blank(),
axis.title = element_blank(),panel.grid = element_blank(),
legend.position = "bottom",
text = element_text(color = "#22211d"),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
panel.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = NA),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
vjust = 0.1,
size = 10),
plot.caption = element_text(size = 7,
hjust = 1))+
labs(fill="Percentage with a \n Disability Sent",
title = "Percentage of Erasmus students \n sent with a Disability (2014-2020)")+
scale_fill_gradientn(colors = met.brewer("VanGogh3",type="continuous"),
labels= c("0","2%","4%","6%"))
map_disability_send
rlang::last_error()
map_disability_send <- ggplot() +
geom_polygon(data = map_europe_disability,
aes(x = long, y = lat, group = group,
fill = perc_send)) +
theme(axis.ticks = element_blank(),axis.text = element_blank(),
axis.title = element_blank(),panel.grid = element_blank(),
legend.position = "bottom",
text = element_text(color = "#22211d"),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
panel.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = NA),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
vjust = 0.1,
size = 10),
plot.caption = element_text(size = 7,
hjust = 1))+
labs(fill="Percentage with a \n Disability Sent",
title = "Percentage of Erasmus students \n sent with a Disability (2014-2020)")+
scale_fill_gradientn(colors = met.brewer("VanGogh3",type="continuous"),
breaks=c(0,2,4,6)
labels= c("0","2%","4%","6%"))
map_disability_send
map_disability_send <- ggplot() +
geom_polygon(data = map_europe_disability,
aes(x = long, y = lat, group = group,
fill = perc_send)) +
theme(axis.ticks = element_blank(),axis.text = element_blank(),
axis.title = element_blank(),panel.grid = element_blank(),
legend.position = "bottom",
text = element_text(color = "#22211d"),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
panel.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = NA),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
vjust = 0.1,
size = 10),
plot.caption = element_text(size = 7,
hjust = 1))+
labs(fill="Percentage with a \n Disability Sent",
title = "Percentage of Erasmus students \n sent with a Disability (2014-2020)")+
scale_fill_gradientn(colors = met.brewer("VanGogh3",type="continuous"),
breaks=c(0,2,4,6),
labels= c("0","2%","4%","6%"))
map_disability_send
map_disability_send + map_disability_receive
erasmus %>% tabyl(academic_year) %>% adorn_totals()
erasmus %>% tabyl(sending_country_code)
ggplot(erasmus ,aes(x=sending_country_code))+
geom_bar()
ggplot(erasmus,aes(x=sending_country_code))+
geom_bar()+
coord_flip()
erasmus %>% tabyl(special_needs)
library(gghighlight)
install.packages("gghighlight")
library(gghighlight)
ggplot(erasmus,aes(x=sending_country_code))+
geom_bar()+
coord_flip()+
gghighlight()
ggplot(erasmus,aes(x=sending_country_code))+
geom_bar()+
coord_flip()+
gghighlight(value>5000)
ggplot(erasmus,aes(x=sending_country_code))+
geom_bar(aes(color=sending_country_code))+
coord_flip()+
gghighlight(value>5000)
ggplot(erasmus,aes(x=sending_country_code))+
geom_bar(aes(color=sending_country_code))+
coord_flip()+
gghighlight(value>5000)
ggplot(erasmus,aes(x=sending_country_code))+
geom_bar(aes(color=sending_country_code))+
coord_flip()
ggplot(erasmus,aes(x=sending_country_code))+
geom_bar(aes(fill=sending_country_code))+
coord_flip()
ggplot(erasmus,aes(x=sending_country_code))+
geom_bar(aes(fill=sending_country_code))+
coord_flip()+
gghighlight(value > 5000)
?gghighlight
ggplot(erasmus,aes(x=sending_country_code))+
geom_bar(aes(fill=sending_country_code))+
coord_flip()+
gghighlight(max_highlight = 5L)
geom_bar(aes()+
ggplot(erasmus,aes(x=sending_country_code))+
geom_bar(aes())+
coord_flip()+
gghighlight(max_highlight = 5L)
ggplot(erasmus,aes(x=sending_country_code))+
geom_bar(aes())+
coord_flip()+
gghighlight(max_highlight = 5L)
ggplot(erasmus,aes(x=sending_country_code))+
geom_bar(aes())+
coord_flip()+
gghighlight(max_highlight = 5L)
?gghighlight
ggplot(erasmus,aes(x=sending_country_code))+
geom_bar(aes(fill=sending_country_code))+
coord_flip()+
gghighlight(max(value), max_highlight = 5L)
ggplot(erasmus,aes(x=sending_country_code))+
geom_bar(aes(fill=sending_country_code))+
coord_flip()+
gghighlight(max(value), max_highlight = 5L)
erasmus %>% tabyl(sending_country_code)
options(schipen=999)
erasmus %>% tabyl(sending_country_code)
options(scipen=999)
erasmus %>% tabyl(sending_country_code)
erasmus %>% tabyl(special_needs,round)
?tabyl
erasmus %>% tabyl(sending_country_code)
erasmus %>% tabyl(special_needs,round)
erasmus %>% tabyl(special_needs,round)
erasmus %>% tabyl(special_needs)
erasmus %>% tabyl(academic_year) %>% adorn_totals()
#erasmus %>% tabyl(sending_country_code)
erasmus %>% tabyl(special_needs)
sending_country<- erasmus %>%
group_by(sending_country_code) %>%
summarize(total_send=n())
sending_country
sending_country <- erasmus %>%
group_by(sending_country_code) %>%
summarize(total_send=n()) %>% arrange()
sending_country
sending_country %>% arrange(total_send)
sending_country %>% arrange(desc(total_send))
sending_country <- erasmus %>%
group_by(sending_country_code) %>%
summarize(total_send=n()) %>% arrange()
sending_country_disability <- erasmus %>%
group_by(sending_country_code) %>%
filter(special_needs == "Yes") %>%
summarize(special_needs_send = n())
sending_country <- erasmus %>%
group_by(sending_country_code) %>%
summarize(total_send=n()) %>% arrange()
disability_sending <- left_join(sending_country_disability,
sending_country,
by="sending_country_code") %>%
rename(country_code = sending_country_code) %>%
mutate(perc_send = round((special_needs_send / total_send)*100, digits = 4))
receiving_country_disability <- erasmus %>%
group_by(receiving_country_code) %>%
filter(special_needs == "Yes") %>%
summarize(special_needs_receive=n())
receiving_country<- erasmus %>%
group_by(receiving_country_code) %>%
summarize(total_receive=n())
disability_receiving <- left_join(receiving_country_disability,
receiving_country,
by="receiving_country_code") %>%
rename(country_code = receiving_country_code) %>%
mutate(perc_receive = round((special_needs_receive / total_receive)*100, digits = 4))
disability_data <- full_join(disability_sending,
disability_receiving,
by="country_code") %>%
arrange(country_code)
disability_data[disability_data == 'UK'] <- 'GB'
disability_data[disability_data == 'EL'] <- 'GR'
disability_data <- left_join(disability_data,
country_codes,
by="country_code")
rename = setdiff(disability_data$name,map_world$country)
rename
disability_data$name <- recode(disability_data$name,
"Czechia" = "Czech Republic",
"United Kingdom" = "UK",
"Moldova, Republic of" = "Moldova",
"Russian Federation" = "Russia")
disability_data <- disability_data %>% rename(country = "name")
#remove Russia
disability_data <- disability_data %>% filter(country != "Russia")
disability_data[is.na(disability_data)] = 0
#filter erasmus Europe map data
europe_map <- map_world %>% filter(country%in%disability_data$country)
# remove norway artic islands from the map
europe_map <- europe_map %>% filter(lat < 74)
disability_data %>% arrange(sending_countries)
disability_data %>% arrange(desc(total_send))
disability_data %>% arrange(desc(total_send)) %>% select(name,total_send,total_receive)
disability_data %>% arrange(desc(total_send)) %>% select(name,total_send,total_receive)
disability_data %>% arrange(desc(total_send)) %>% select(country,total_send,total_receive,perc_send,perc_receive)
disability_data_simple <- disability_data %>% arrange(desc(total_send)) %>% select(country,total_send,total_receive,perc_send,perc_receive,special_needs_send,special_needs_receive)
disability_data_simple
disability_data %>% arrange(desc(total_send)) %>% select(country,total_send,special_needs_send,perc_send)
#Most persons with disability sent abroad
disability_data %>% arrange(desc(special_needs_send)) %>% select(country,total_send,special_needs_send,perc_send)
#highest perentage of students with disability sent abroad
disability_data %>% arrange(desc(perc_send)) %>% select(country,total_send,special_needs_send,perc_send)
#Most student received from abroad
disability_data %>% arrange(desc(total_receive)) %>% select(country,total_receive,special_needs_receive,perc_receive)
#Most persons with disability received from  abroad
disability_data %>% arrange(desc(special_needs_receive)) %>% select(country,total_receive,special_needs_receive,perc_receive)
#highest perentage of students with disability received from abroad
disability_data %>% arrange(desc(perc_receive)) %>% select(country,total_receive,special_needs_receive,perc_receive)
map_europe_disability <- left_join(europe_map,disability_data,by = "country")
map_disability_send <- ggplot() +
geom_polygon(data = map_europe_disability,
aes(x = long, y = lat, group = group,
fill = perc_send)) +
theme(axis.ticks = element_blank(),axis.text = element_blank(),
axis.title = element_blank(),panel.grid = element_blank(),
legend.position = "bottom",
text = element_text(color = "#22211d"),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
panel.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = NA),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
vjust = 0.1,
size = 10),
plot.caption = element_text(size = 7,
hjust = 1))+
labs(fill="Percentage with a \n Disability Sent",
title = "Percentage of Erasmus students \n received from abroad with \n a Disability (2014-2020)")+
scale_fill_gradientn(colors = met.brewer("VanGogh3",type="continuous"),
breaks=c(0,2,4,6),
labels= c("0","2%","4%","6%"))
map_disability_send
map_disability_receive <- ggplot() +
geom_polygon(data = map_europe_disability,
aes(x = long, y = lat, group = group,
fill = perc_receive)) +
theme(axis.ticks = element_blank(),axis.text = element_blank(),
axis.title = element_blank(),panel.grid = element_blank(),
legend.position = "bottom",
text = element_text(color = "#22211d"),
plot.background = element_rect(fill = "#f5f5f2", color = NA),
panel.background = element_rect(fill = "#f5f5f2", color = NA),
legend.background = element_rect(fill = "#f5f5f2", color = NA),
plot.title = element_text(hjust = 0.5,
vjust = 0.1,
size = 12,
face = "bold"),
plot.subtitle = element_text(hjust = 0.5,
vjust = 0.1,
size = 10),
plot.caption = element_text(size = 7,
hjust = 1))+
labs(fill="Percentage with a \n Disability Received",
title = "Percentage of Erasmus students \n going abroad who have \n a Disability (2014-2020)",
caption = "Created by Matthew Kusen - @mkusen \n
data source: Erasmus Student Mobility - https://data.europa.eu \n #TidyTuesday")+
scale_fill_gradientn(colors = met.brewer("Hokusai2",type="continuous"),
labels= c("0", "2%", "4%", "6%"))
map_disability_receive
library(patchwork)
map_disability_send + map_disability_receive
